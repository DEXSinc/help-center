<!--
@license
Copyright (c) 2016 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->

<link rel="import" href="../../bower_components/polymer/polymer.html">

<dom-module id="app-faqs">

  <template>

    <style is="custom-style" include="paper-item-shared-styles iron-flex iron-flex-alignment">
      :host {
        display: block;
        padding: 10px;
      }
      .card {
        box-shadow: 0 2px 2px 0 rgba(0, 0, 0, 0.14), 0 1px 5px 0 rgba(0, 0, 0, 0.12), 0 3px 1px -2px rgba(0, 0, 0, 0.2);
        padding: 16px;
        margin: 24px;
        border-radius: 5px;
        background-color: #fff;
        color: #757575;
        min-height: calc(90vh - 100px);
      }
      .circle {
        display: inline-block;
        height: 64px;
        width: 64px;
        border-radius: 50%;
        background: #ddd;
        line-height: 64px;
        font-size: 30px;
        color: #555;
        text-align: center;
      }

      h1 {
        font-size: 22px;
        margin: 16px 0;
        color: #212121;
      }

      faq-item {
          --faq-question-item: {
              @apply(--paper-font-body2);
              cursor: pointer;
          };

          --faq-answer-item: {
              @apply(--paper-font-body1);
              overflow: hidden;
              background-color: white;
          };
      }

      faq-item * img {
          width: 16px;
          height: 16px;
      }

      .videos-list {
          padding: 10px;
          display: block;
          width: 360px;
          min-height: 400px;
          /*height: auto;*/
          padding-top: 32px;
      }

      paper-card {
          border-top: solid 4px #34b6e4;
          -ms-border-radius: 0;
          border-radius: 0;
          width: 360px;
      }

      paper-card.faq-group-0 {
          border-top: solid 4px #fe7701;
      }

      paper-card.faq-group-1 {
          border-top: solid 4px #0c4c8a;
      }

      .box-title {
          @apply(--paper-font-title);
          margin-left: 10px;
          margin-top: 10px;
          color: #6a737b;
          background-color: #fff;
          width: 350px;
      }

      .page-title {
          @apply(--paper-font-display1);
          padding-top: 32px;
      }

      @media only screen and (max-width: 600px) {
          .videos-list {
              width: 100%;
              padding-left: 0;
              padding-right: 0;
          }

          paper-card {
              margin: 0;
              width: 100%;
          }
      }

      #app-spinner {
        position: absolute;
        left: 50%;
        top: 33%;
        -webkit-transform: translateX(-50%);
        -moz-transform: translateX(-50%);
        -ms-transform: translateX(-50%);
        -o-transform: translateX(-50%);
        transform: translateX(-50%);
        -webkit-transition: visibility 0.6s, all 0.6s;
        -moz-transition: visibility 0.6s, all 0.6s;
        -ms-transition: visibility 0.6s, all 0.6s;
        -o-transition: visibility 0.6s, all 0.6s;
        transition: visibility 0.6s, all 0.6s;
      }

      paper-spinner.blue {
        height: 100px;
        width: 100px;
        --paper-spinner-stroke-width: 2px;
        --paper-spinner-layer-1-color: var(--acquisio-blue-100);
        --paper-spinner-layer-2-color: var(--acquisio-blue-900);
        --paper-spinner-layer-3-color: var(--acquisio-blue-100);
        --paper-spinner-layer-4-color: var(--acquisio-blue-900);
        --paper-spinner-color: var(--acquisio-blue-100);
      }

      @media only screen and (max-width: 800px) {
        #app-spinner {
          position: absolute;
          top: 30%;
          left: 50%;
          -webkit-transform: translateY(-30%) translateX(-50%);
          -moz-transform: translateY(-30%) translateX(-50%);
          -ms-transform: translateY(-30%) translateX(-50%);
          -o-transform: translateY(-30%) translateX(-50%);
          transform: translateY(-30%) translateX(-50%);
        }
      }
    </style>

    <app-route
        route="{{subRoute}}"
        pattern="/:id"
        data="{{articleData}}">
    
    <iron-ajax id="faqSearchFeed"
           url="https://localhost.acquisio.com/services/api/v1/faqs/{{category}}"
           method="GET"
           auto
           last-response="{{faqResult}}"
           loading="{{faqsLoading}}"
           on-response="_onFaqsResult"></iron-ajax>

    <iron-media-query query="(min-width: 600px)" query-matches="{{queryMatches}}"></iron-media-query>
    
    <div id="app-spinner" hidden$="{{!faqsLoading}}">
      <paper-spinner class="blue" active></paper-spinner>
    </div>

    <div class="card layout vertical center">
        <div class="page-title">Frequently Asked Questions</div>
        <div class="layout horizontal center-justified wrap">

            <paper-header-panel style="height: 100px;" mode="cover">
                <div class="paper-header">Header</div>
                <div>Content goes here...</div>
            </paper-header-panel>
            <template is="dom-repeat" items="[[faqResult]]" as="faqGroup">
                <div class$="videos-list [[_elevated(queryMatches)]]">
                    <paper-card class$="faq-group-[[index]]" elevation="[[_getElevation(queryMatches)]]">
                        <div class="layout vertical">
                            <div class="box-title">[[faqGroup.Category]]</div>
                            <div style="height: 320px; padding-top: 10px; margin: 0;">
                                <iron-list style="height: 100%;" items="[[faqGroup.FAQs]]" as="faq">
                                    <template>
                                        <faq-item question="[[faq.Question]]" category="[[faq.Category]]" last-modified="[[faq.LastModified]]">
                                            <marked-element markdown="[[faq.Answer]]">
                                                <div class="markdown-html"></div>
                                            </marked-element>
                                        </faq-item>
                                    </template>
                                </iron-list>
                            </div>
                        </div>
                    </paper-card>
                </div>
            </template>
        </div>
    </div>
  </template>

  <script>

    Polymer({

      is: 'app-faqs',
      properties: {
        category: {
          type: String,
          value: ''
        },
        faqsLoading: {
          type: Boolean,
          value: false
        },
        queryMatches: {
          type: Boolean,
          value: false
        },
        faqResult: {
          type: Array,
          value: function() {
            return [];
          }
        }
      },
      observers: [
        '_articleDataIdChanged(articleData.id)'
      ],
      _articleDataIdChanged: function(id) {
        this.category = id;
      },
      _onFaqsResult: function (r) {
        console.log(r);
      },
      _elevated: function (b) {
        return b ? 'elevated' : '';
      },
      _getElevation: function (b) {
        return b ? 1 : 0;
      }

    });

  </script>

</dom-module>
